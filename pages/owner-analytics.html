<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics & Reports - Go Tawee Merchant</title>
    <link rel="stylesheet" href="../css/style.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="../assets/images/Logo.png" alt="Go Tawee Logo" class="sidebar-logo">
            <h2 class="sidebar-title">Go Tawee</h2>
        </div>
        
        <nav class="sidebar-nav">
            <a href="owner-dashboard.html" class="nav-item">
                <span class="material-icons">dashboard</span>
                <span>Dashboard</span>
            </a>
            <a href="owner-menu.html" class="nav-item">
                <span class="material-icons">restaurant_menu</span>
                <span>Menu Management</span>
            </a>
            <a href="owner-analytics.html" class="nav-item active">
                <span class="material-icons">analytics</span>
                <span>Analytics & Reports</span>
            </a>
            <a href="owner-staff.html" class="nav-item">
                <span class="material-icons">people</span>
                <span>Staff Management</span>
            </a>
            <a href="owner-settings.html" class="nav-item">
                <span class="material-icons">settings</span>
                <span>Profile & Settings</span>
            </a>
        </nav>

        <div class="sidebar-footer">
            <a href="../index.html" class="nav-item">
                <span class="material-icons">logout</span>
                <span>Sign Out</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <header class="dashboard-header">
            <button class="menu-toggle" id="menu-btn">
                <span class="material-icons">menu</span>
            </button>
            <h1 class="page-title">Analytics & Reports</h1>
            <button class="export-btn" id="export-btn">
                <span class="material-icons">download</span>
            </button>
        </header>

        <!-- Analytics Content -->
        <div class="dashboard-container">
            <!-- Enhanced Time Period Filters -->
            <div class="period-selector-container">
                <div class="period-filters-wrapper">
                    <!-- Quick Filters -->
                    <div class="period-quick-filters">
                        <button class="period-option active" data-period="today">Today</button>
                        <button class="period-option" data-period="yesterday">Yesterday</button>
                        <button class="period-option" data-period="week">This Week</button>
                        <button class="period-option" data-period="month">This Month</button>
                        <div class="period-dropdown">
                            <button class="period-option dropdown-toggle" id="advanced-filter-btn">
                                More Filters
                                <span class="material-icons">expand_more</span>
                            </button>
                            <div class="period-dropdown-menu" id="advanced-filter-menu">
                                <button class="dropdown-item" data-period="last7">Last 7 Days</button>
                                <button class="dropdown-item" data-period="last30">Last 30 Days</button>
                                <button class="dropdown-item" data-period="last90">Last 90 Days</button>
                                <div class="dropdown-divider"></div>
                                <button class="dropdown-item" data-period="quarter" id="quarterly-btn">
                                    <span class="material-icons">date_range</span>
                                    Quarterly View
                                </button>
                                <button class="dropdown-item" data-period="year" id="yearly-btn">
                                    <span class="material-icons">calendar_today</span>
                                    Yearly View
                                </button>
                                <button class="dropdown-item" data-period="custom" id="custom-range-btn">
                                    <span class="material-icons">event</span>
                                    Custom Range
                                </button>
                                <div class="dropdown-divider"></div>
                                <button class="dropdown-item" id="compare-toggle">
                                    <span class="material-icons">compare_arrows</span>
                                    Compare Periods
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Filter Display -->
                    <div class="active-filter-display" id="active-filter-display" style="display: none;">
                        <span class="filter-label" id="filter-label"></span>
                        <button class="filter-clear" id="clear-filter">
                            <span class="material-icons">close</span>
                        </button>
                    </div>
                </div>
                
                <!-- Quarterly Selector (Hidden by default) -->
                <div class="quarterly-selector" id="quarterly-selector" style="display: none;">
                    <div class="quarter-options">
                        <button class="quarter-option" data-quarter="Q1">Q1 (Jan-Mar)</button>
                        <button class="quarter-option" data-quarter="Q2">Q2 (Apr-Jun)</button>
                        <button class="quarter-option" data-quarter="Q3">Q3 (Jul-Sep)</button>
                        <button class="quarter-option" data-quarter="Q4">Q4 (Oct-Dec)</button>
                    </div>
                    <select class="year-picker" id="quarter-year-picker">
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026" selected>2026</option>
                    </select>
                </div>
                
                <!-- Yearly Selector (Hidden by default) -->
                <div class="yearly-selector" id="yearly-selector" style="display: none;">
                    <label class="year-label">Select Year:</label>
                    <select class="year-picker-large" id="year-picker">
                        <option value="2024">2024</option>
                        <option value="2025">2025</option>
                        <option value="2026" selected>2026</option>
                    </select>
                </div>
            </div>
            
            <!-- Filter Tags & Categories -->
            <div class="filters-bar" id="filters-bar">
                <div class="filter-section">
                    <label class="filter-section-label">Category:</label>
                    <div class="filter-tags">
                        <button class="filter-tag active" data-category="all">All</button>
                        <button class="filter-tag" data-category="main">Main Course</button>
                        <button class="filter-tag" data-category="appetizers">Appetizers</button>
                        <button class="filter-tag" data-category="desserts">Desserts</button>
                        <button class="filter-tag" data-category="beverages">Beverages</button>
                    </div>
                </div>
                <div class="filter-section">
                    <label class="filter-section-label">Item Type:</label>
                    <div class="filter-tags">
                        <button class="filter-tag active" data-itemtype="all">All Items</button>
                        <button class="filter-tag" data-itemtype="combo">Combo Meals</button>
                        <button class="filter-tag" data-itemtype="variants">With Variants</button>
                        <button class="filter-tag" data-itemtype="popular">Top 20%</button>
                    </div>
                </div>
            </div>

            <!-- Sales Overview Cards -->
            <div class="analytics-grid">
                <div class="analytics-card">
                    <div class="analytics-icon" style="background: rgba(35, 126, 86, 0.15);">
                        <span class="material-icons" style="color: var(--turf-green);">trending_up</span>
                    </div>
                    <div class="analytics-content">
                        <p class="analytics-label">Total Sales</p>
                        <h3 class="analytics-value">₱12,540</h3>
                        <p class="analytics-change positive">
                            <span class="material-icons">arrow_upward</span>
                            12.5% vs yesterday
                        </p>
                    </div>
                </div>

                <div class="analytics-card">
                    <div class="analytics-icon" style="background: rgba(253, 188, 34, 0.15);">
                        <span class="material-icons" style="color: var(--amber-flame);">receipt_long</span>
                    </div>
                    <div class="analytics-content">
                        <p class="analytics-label">Total Orders</p>
                        <h3 class="analytics-value">48</h3>
                        <p class="analytics-change positive">
                            <span class="material-icons">arrow_upward</span>
                            8.3% vs yesterday
                        </p>
                    </div>
                </div>

                <div class="analytics-card">
                    <div class="analytics-icon" style="background: rgba(234, 210, 144, 0.2);">
                        <span class="material-icons" style="color: var(--evergreen);">shopping_cart</span>
                    </div>
                    <div class="analytics-content">
                        <p class="analytics-label">Avg Order Value</p>
                        <h3 class="analytics-value">₱261</h3>
                        <p class="analytics-change positive">
                            <span class="material-icons">arrow_upward</span>
                            4.2% vs yesterday
                        </p>
                    </div>
                </div>
            </div>

            <!-- Revenue Trend Chart -->
            <div class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Revenue Trend</h2>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <span class="legend-dot" style="background: var(--turf-green);"></span>
                            <span>Revenue</span>
                        </div>
                    </div>
                </div>
                <div class="trend-chart">
                    <div class="chart-bars">
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 45%;" data-value="₱5,625"></div>
                            <span class="trend-label">Mon</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 62%;" data-value="₱7,750"></div>
                            <span class="trend-label">Tue</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 55%;" data-value="₱6,875"></div>
                            <span class="trend-label">Wed</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 78%;" data-value="₱9,750"></div>
                            <span class="trend-label">Thu</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 85%;" data-value="₱10,625"></div>
                            <span class="trend-label">Fri</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar" style="height: 92%;" data-value="₱11,500"></div>
                            <span class="trend-label">Sat</span>
                        </div>
                        <div class="trend-bar-wrapper">
                            <div class="trend-bar active" style="height: 100%;" data-value="₱12,500"></div>
                            <span class="trend-label">Sun</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Order Trends -->
            <div class="section-card">
                <h2 class="section-title">Order Trends</h2>
                <div class="trends-grid">
                    <div class="trend-card">
                        <div class="trend-icon">
                            <span class="material-icons">schedule</span>
                        </div>
                        <div class="trend-content">
                            <p class="trend-title">Peak Hours</p>
                            <p class="trend-value">12PM - 2PM</p>
                            <p class="trend-subtitle">Lunch rush</p>
                        </div>
                    </div>

                    <div class="trend-card">
                        <div class="trend-icon">
                            <span class="material-icons">calendar_today</span>
                        </div>
                        <div class="trend-content">
                            <p class="trend-title">Busiest Day</p>
                            <p class="trend-value">Sunday</p>
                            <p class="trend-subtitle">Average 68 orders</p>
                        </div>
                    </div>

                    <div class="trend-card">
                        <div class="trend-icon">
                            <span class="material-icons">access_time</span>
                        </div>
                        <div class="trend-content">
                            <p class="trend-title">Avg Prep Time</p>
                            <p class="trend-value">18 mins</p>
                            <p class="trend-subtitle">-2 min vs last week</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- New Analytics Cards -->
            <div class="analytics-extended-grid">
                <!-- Profit Card -->
                <div class="analytics-card-extended">
                    <div class="card-header-extended">
                        <span class="material-icons card-icon">account_balance_wallet</span>
                        <h3 class="card-title-extended">Total Profit</h3>
                    </div>
                    <div class="card-value-large" id="total-profit">₱8,540</div>
                    <div class="card-subtitle">
                        <span class="profit-margin-badge">68% margin</span>
                    </div>
                </div>
                
                <!-- Customers Card -->
                <div class="analytics-card-extended">
                    <div class="card-header-extended">
                        <span class="material-icons card-icon">groups</span>
                        <h3 class="card-title-extended">Total Customers</h3>
                    </div>
                    <div class="card-value-large" id="total-customers">342</div>
                    <div class="card-subtitle">
                        <span class="return-rate-badge">42% return rate</span>
                    </div>
                </div>
                
                <!-- Most Ordered Item Card -->
                <div class="analytics-card-extended">
                    <div class="card-header-extended">
                        <span class="material-icons card-icon">star</span>
                        <h3 class="card-title-extended">Most Ordered</h3>
                    </div>
                    <div class="card-value-medium" id="most-ordered-item">Chicken Inasal</div>
                    <div class="card-subtitle" id="most-ordered-count">248 orders</div>
                </div>
                
                <!-- Stock Value Card -->
                <div class="analytics-card-extended">
                    <div class="card-header-extended">
                        <span class="material-icons card-icon">inventory_2</span>
                        <h3 class="card-title-extended">Stock Value</h3>
                    </div>
                    <div class="card-value-large" id="stock-value">₱45,230</div>
                    <div class="card-subtitle">
                        <span class="low-stock-alert" id="low-stock-alert">3 items low</span>
                    </div>
                </div>
            </div>
            
            <!-- Category Breakdown Pie Chart -->
            <div class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Sales by Category</h2>
                    <button class="chart-expand-btn" title="Expand Chart">
                        <span class="material-icons">fullscreen</span>
                    </button>
                </div>
                <div class="pie-chart-container">
                    <canvas id="categoryPieChart" width="400" height="250"></canvas>
                    <div class="pie-chart-legend" id="pie-legend"></div>
                </div>
            </div>
            
            <!-- Line Chart for Multi-Metric Trends -->
            <div class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Sales & Orders Trend</h2>
                    <div class="chart-legend">
                        <div class="legend-item">
                            <span class="legend-dot" style="background: var(--turf-green);"></span>
                            <span>Sales</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-dot" style="background: var(--amber-flame);"></span>
                            <span>Orders</span>
                        </div>
                    </div>
                </div>
                <div class="line-chart-container">
                    <canvas id="trendLineChart" width="400" height="200"></canvas>
                </div>
            </div>
            
            <!-- Heatmap for Order Volume by Time -->
            <div class="section-card">
                <div class="section-header">
                    <h2 class="section-title">Order Heatmap (Day x Hour)</h2>
                    <span class="subtitle">Darker = More Orders</span>
                </div>
                <div class="heatmap-container" id="orderHeatmap"></div>
            </div>
            
            <!-- Data Insights & Predictions -->
            <div class="section-card insights-card">
                <div class="section-header">
                    <h2 class="section-title">
                        <span class="material-icons">lightbulb</span>
                        Business Insights
                    </h2>
                </div>
                <div class="insights-list" id="insights-list">
                    <!-- Dynamically populated -->
                </div>
            </div>

            <!-- Staff Performance - ARCHIVED -->
            <!--
            <div class="section-card">
                <h2 class="section-title">Staff Performance</h2>
                <div class="staff-performance-list">
                    <div class="performance-item">
                        <div class="staff-avatar">
                            <span class="material-icons">person</span>
                        </div>
                        <div class="staff-info">
                            <p class="staff-name">Maria Santos</p>
                            <p class="staff-role">Server</p>
                        </div>
                        <div class="staff-stats">
                            <p class="stat-value">127 orders</p>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 100%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="performance-item">
                        <div class="staff-avatar">
                            <span class="material-icons">person</span>
                        </div>
                        <div class="staff-info">
                            <p class="staff-name">Juan Dela Cruz</p>
                            <p class="staff-role">Server</p>
                        </div>
                        <div class="staff-stats">
                            <p class="stat-value">98 orders</p>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 77%;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="performance-item">
                        <div class="staff-avatar">
                            <span class="material-icons">person</span>
                        </div>
                        <div class="staff-info">
                            <p class="staff-name">Ana Reyes</p>
                            <p class="staff-role">Server</p>
                        </div>
                        <div class="staff-stats">
                            <p class="stat-value">85 orders</p>
                            <div class="stat-bar">
                                <div class="stat-fill" style="width: 67%;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            -->
        </div>
    </div>
    
    <!-- Custom Date Range Modal -->
    <div class="modal" id="date-range-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content date-range-modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Select Date Range</h2>
                <button class="modal-close" id="date-range-close">
                    <span class="material-icons">close</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="date-range-quick-picks">
                    <button class="quick-range-btn" data-range="7">Last 7 Days</button>
                    <button class="quick-range-btn" data-range="30">Last 30 Days</button>
                    <button class="quick-range-btn" data-range="90">Last 90 Days</button>
                    <button class="quick-range-btn" data-range="365">Last Year</button>
                </div>
                <div class="date-inputs-row">
                    <div class="date-input-group">
                        <label class="date-label">Start Date</label>
                        <input type="date" id="start-date" class="date-input">
                    </div>
                    <div class="date-input-group">
                        <label class="date-label">End Date</label>
                        <input type="date" id="end-date" class="date-input">
                    </div>
                </div>
                <div class="date-range-info" id="date-range-info"></div>
            </div>
            <div class="modal-actions">
                <button class="btn-secondary" id="date-range-cancel">Cancel</button>
                <button class="btn-primary" id="date-range-apply">Apply Range</button>
            </div>
        </div>
    </div>

    <script src="../js/utils.js"></script>
    <script src="../js/app.js"></script>
    <script src="../js/analytics.js"></script>
</body>
</html>
